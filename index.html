<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOL çŸ¥è¯†å¤§è€ƒéªŒ</title>
    <style>
        :root {
            --gold: #C8AA6E;
            --gold-dim: #937341;
            --blue-dark: #091428;
            --hextech: #0AC8B9;
            --text: #F0E6D2;
            --red: #ff4c4c;
            --bg-gradient: radial-gradient(circle at center, #1a2c42 0%, #091428 100%);
        }

        body {
            background-color: var(--blue-dark);
            color: var(--text);
            font-family: "Microsoft YaHei", sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-image: var(--bg-gradient);
            user-select: none;
        }

        /* æ¸¸æˆä¸»å®¹å™¨ */
        .container {
            background: rgba(10, 50, 60, 0.9);
            border: 2px solid var(--gold);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.6);
            text-align: center;
            width: 90%;
            max-width: 500px;
            position: relative;
            display: none;
        }

        /* é¡¶éƒ¨è®¡åˆ†æ¿ */
        .header-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(200, 170, 110, 0.3);
            padding-bottom: 10px;
            font-size: 14px;
            color: var(--gold);
        }
        .score-val { color: var(--hextech); font-weight: bold; font-size: 18px; }

        /* å›¾ç‰‡åŒºåŸŸ */
        .img-wrapper {
            position: relative;
            width: 110px;
            height: 110px;
            margin: 0 auto 20px;
        }
        
        .img-box {
            width: 100%;
            height: 100%;
            border: 3px solid var(--gold);
            background: #000;
            box-shadow: 0 0 20px rgba(200, 170, 110, 0.2);
            overflow: hidden;
        }

        .img-box img { width: 100%; height: 100%; object-fit: cover; }

        .difficulty-tag {
            position: absolute;
            top: -10px; right: -10px;
            background: var(--blue-dark);
            border: 1px solid var(--gold);
            color: var(--gold);
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
        }

        /* äº¤äº’åŒº */
        input[type="text"] {
            padding: 12px;
            border: 1px solid var(--gold-dim);
            background: rgba(0,0,0,0.4);
            color: var(--text);
            border-radius: 4px;
            font-size: 16px;
            width: 70%;
            text-align: center;
            outline: none;
            transition: 0.3s;
            margin-bottom: 15px;
        }
        input[type="text"]:focus { border-color: var(--hextech); box-shadow: 0 0 10px rgba(10, 200, 185, 0.2); }

        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 10px;
            cursor: pointer;
            border: 1px solid transparent;
            font-weight: bold;
            border-radius: 4px;
            background: transparent;
            color: var(--text);
            transition: all 0.2s;
        }

        .btn-confirm { background: var(--gold); color: var(--blue-dark); width: 100%; margin-bottom: 15px; }
        .btn-confirm:hover { filter: brightness(1.1); }

        .btn-hint { border-color: var(--hextech); color: var(--hextech); }
        .btn-hint:hover { background: rgba(10, 200, 185, 0.1); }

        .btn-skip { border-color: var(--red); color: var(--red); }
        .btn-skip:hover { background: rgba(255, 76, 76, 0.1); }

        /* å¯åŠ¨ç•Œé¢ */
        #start-screen {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(5, 10, 20, 0.98);
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .mode-select {
            display: flex;
            gap: 20px;
            margin: 30px 0;
        }

        .mode-btn {
            background: rgba(255,255,255,0.05);
            border: 2px solid var(--gold-dim);
            padding: 20px;
            width: 140px;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            opacity: 0.6;
        }
        .mode-btn.active {
            border-color: var(--hextech);
            background: rgba(10, 200, 185, 0.1);
            opacity: 1;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(10, 200, 185, 0.2);
        }
        .mode-title { font-size: 18px; font-weight: bold; color: var(--text); display: block; margin-bottom: 5px; }
        .mode-desc { font-size: 12px; color: #aaa; display: block; }

        .start-play-btn {
            padding: 15px 60px;
            font-size: 20px;
            background: var(--gold);
            color: var(--blue-dark);
            border: none;
            opacity: 0.5;
            pointer-events: none;
            font-weight: bold;
        }
        .start-play-btn.ready { opacity: 1; pointer-events: all; }
        .start-play-btn.ready:hover { background: #E6C888; transform: scale(1.05); }

        /* åé¦ˆæ¶ˆæ¯ */
        #message { min-height: 40px; display: flex; align-items: center; justify-content: center; font-size: 15px; }
        .success { color: var(--hextech); }
        .error { color: var(--red); }
        .info { color: var(--gold); }
    </style>
</head>
<body>

<!-- å¯åŠ¨ç•Œé¢ -->
<div id="start-screen">
    <h1 style="color:var(--gold); font-size: 32px; letter-spacing: 2px;">LOL æŒ‘æˆ˜èµ›</h1>
    
    <div class="mode-select">
        <div class="mode-btn active" onclick="selectMode('normal')" id="btn-normal">
            <span class="mode-title">ğŸŸ¢ æ­£å¸¸éš¾åº¦</span>
            <span class="mode-desc">çœ‹å›¾æ ‡çŒœè‹±é›„<br>æ”¯æŒå¤–å·/ç®€ç§°</span>
        </div>
        <div class="mode-btn" onclick="selectMode('hard')" id="btn-hard">
            <span class="mode-title">ğŸ”´ å›°éš¾éš¾åº¦</span>
            <span class="mode-desc">çœ‹å›¾æ ‡çŒœæŠ€èƒ½å<br>å…¨åå¿…é¡»ç²¾ç¡®</span>
        </div>
    </div>

    <div id="loading-status" style="color: #666; margin-bottom: 20px;">æ­£åœ¨è¿æ¥ç¬¦æ–‡ä¹‹åœ°...</div>
    <button id="start-game-btn" class="start-play-btn" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>
</div>

<!-- æ¸¸æˆç•Œé¢ -->
<div class="container" id="game-ui">
    <div class="header-bar">
        <div>éš¾åº¦: <span id="current-mode-text" style="color:var(--gold);">æ­£å¸¸</span></div>
        <div>å¾—åˆ†: <span id="score" class="score-val">0</span></div>
        <div>è¿èƒœ: <span id="streak" class="score-val">0</span></div>
    </div>

    <div class="img-wrapper">
        <div class="img-box"><img id="skill-img" src=""></div>
        <div class="difficulty-tag" id="key-tag">?</div>
    </div>

    <h2 id="question-text" style="margin: 0 0 20px 0; font-size: 20px;">è¿™æ˜¯è°çš„æŠ€èƒ½ï¼Ÿ</h2>

    <input type="text" id="answer-input" placeholder="è¾“å…¥ç­”æ¡ˆ..." autocomplete="off">
    
    <button class="btn-confirm" onclick="checkAnswer()">ç¡®å®š</button>
    
    <div class="btn-grid">
        <button class="btn-hint" onclick="useHint()">ğŸ’¡ æç¤º <span id="hint-count">(0/2)</span></button>
        <button class="btn-skip" onclick="skipRound()">â­ è·³è¿‡</button>
    </div>

    <div id="message"></div>
</div>

<script>
    // --- æ ¸å¿ƒé…ç½® ---
    const DD_BASE = "https://ddragon.leagueoflegends.com";
    let gameState = {
        version: '',
        champions: {},
        mode: 'normal', // 'normal' | 'hard'
        score: 0,
        streak: 0,
        hintLevel: 0,
        currentHero: null,
        currentSkill: null
    };

    // --- å›½æœå¤–å·/ç®€ç§° æ•°æ®åº“ (é»‘ç§‘æŠ€éƒ¨åˆ†) ---
    // è¿™é‡Œçš„é”®åå¯¹åº” Riot API çš„ Hero ID
    const NICKNAME_DB = {
        "Aatrox": ["å‰‘é­”", "äºšæ‰˜å…‹æ–¯", "å¤©ç¥ä¸‹å‡¡"],
        "Ahri": ["ç‹ç‹¸", "é˜¿ç‹¸", "åˆ®ç—§å¥³ç‹"],
        "Akali": ["é˜¿å¡ä¸½", "ç¦»ç¾¤ä¹‹åˆº"],
        "Akshan": ["é˜¿å…‹å°š"],
        "Alistar": ["ç‰›å¤´", "é˜¿åˆ©æ–¯å¡”"],
        "Amumu": ["æœ¨æœ¨", "é˜¿æœ¨æœ¨"],
        "Anivia": ["å†°é¸Ÿ", "å‡¤å‡°", "è‰¾å°¼ç»´äºš"],
        "Annie": ["å®‰å¦®", "ç«å¥³"],
        "Aphelios": ["å„æ–ç‰æ–¯", "æœˆç”·", "æ— Eå‡¡"],
        "Ashe": ["è‰¾å¸Œ", "å¯’å†°", "åˆ®ç—§å¸ˆå‚…"],
        "AurelionSol": ["é¾™ç‹", "ç´¢å°”"],
        "Azir": ["æ²™çš‡", "é˜¿å…¹å°”", "é»„é¸¡", "è„†çš®é¸¡"],
        "Bard": ["å·´å¾·"],
        "Belveth": ["å‘å°”ç»´æ–¯", "è™šç©ºé±¼", "æ‰‘æ£±è›¾å­"],
        "Blitzcrank": ["æœºå™¨äºº", "å¸ƒé‡ŒèŒ¨", "é’©å­"],
        "Brand": ["ç«ç”·", "å¸ƒå…°å¾·"],
        "Braum": ["å¸ƒéš†", "é˜²ç›—é—¨"],
        "Briar": ["è´è•¾äºš", "å¸è¡€é¬¼èè‰", "ç–¯ç‹—"],
        "Caitlyn": ["å¥³è­¦", "å‡¯ç‰¹ç³"],
        "Camille": ["é’é’¢å½±", "å¡èœœå°”", "è…¿å§"],
        "Cassiopeia": ["è›‡å¥³", "å¡è¥¿å¥¥ä½©å¨…"],
        "Chogath": ["å¤§è™«å­", "ç§‘åŠ æ–¯"],
        "Corki": ["é£æœº", "åº“å¥‡"],
        "Darius": ["è¯ºæ‰‹", "å¾·è±å„æ–¯", "æ–­å¤´å°", "è´¨æ£€å‘˜"],
        "Diana": ["çšæœˆ", "æˆ´å®‰å¨œ"],
        "DrMundo": ["è’™å¤š", "åŒ»ç”Ÿ"],
        "Draven": ["å¾·è±æ–‡", "æ–‡æ£®ç‰¹"], // åŒ…å«è‘—åä¸»æ’­æ¢—
        "Ekko": ["è‰¾å…‹", "æ—¶é—´åˆºå®¢"],
        "Elise": ["èœ˜è››", "ä¼Šè‰ä¸"],
        "Evelynn": ["å¯¡å¦‡", "ä¼ŠèŠ™ç³"],
        "Ezreal": ["ez", "ä¼Šæ³½ç‘å°”", "å°é»„æ¯›", "æ‹³å¤´äº²å„¿å­"],
        "Fiddlesticks": ["ç¨»è‰äºº", "è´¹å¾·æå…‹"],
        "Fiora": ["å‰‘å§¬", "è²å¥¥å¨œ"],
        "Fizz": ["å°é±¼äºº", "è²å…¹", "å‡¤é›"],
        "Galio": ["åŠ é‡Œå¥¥", "æ­£ä¹‰å·¨åƒ"],
        "Gangplank": ["èˆ¹é•¿", "æ™®æœ—å…‹"],
        "Garen": ["ç›–ä¼¦", "è‰ä¸›ä¼¦", "å¤§å®å‰‘"],
        "Gnar": ["çº³å°”"],
        "Gragas": ["é…’æ¡¶", "å¤æ‹‰åŠ æ–¯"],
        "Graves": ["ç”·æª", "æ ¼é›·ç¦æ–¯", "çº¯çˆ·ä»¬"],
        "Gwen": ["æ ¼æ¸©", "å‰ªåˆ€å¦¹"],
        "Hecarim": ["äººé©¬", "èµ«å¡é‡Œå§†", "å½©è™¹é©¬"],
        "Heimerdinger": ["å¤§å¤´", "é»‘é»˜ä¸æ ¼"],
        "Hwei": ["æ…§", "ç”»å¸ˆ"],
        "Illaoi": ["ä¿„æ´›ä¼Š", "è§¦æ‰‹å¦ˆ", "æµ·å…½ç¥­å¸"],
        "Irelia": ["åˆ€å¦¹", "è‰¾ç‘è‰å¨…", "å¥¶å¥¶"],
        "Ivern": ["è‰¾ç¿", "å°èŠä»–çˆ¹", "è”¡å¾å¤"], // æµè¡Œæ¢—
        "Janna": ["é£å¥³", "è¿¦å¨œ"],
        "JarvanIV": ["çš‡å­", "å˜‰æ–‡", "å‘¨æ°ä¼¦"],
        "Jax": ["æ­¦å™¨", "è´¾å…‹æ–¯", "æ­¦å™¨å¤§å¸ˆ"],
        "Jayce": ["æ°æ–¯", "è®®å‘˜"],
        "Jhin": ["çƒ¬", "ç˜¸å­", "çº¢é¢†çƒ¬"],
        "Jinx": ["é‡‘å…‹ä¸", "æš´èµ°èè‰"],
        "Kaisa": ["å¡è", "è™šç©ºä¹‹å¥³", "èŸ‘è‚å©†"],
        "Kalista": ["æ»‘æ¿é‹", "å¡è‰æ–¯å¡”", "é•¿çŸ›"],
        "Karma": ["å¡å°”ç›", "æ‰‡å­å¦ˆ"],
        "Karthus": ["æ­»æ­Œ", "å¡å°”è¨æ–¯"],
        "Kassadin": ["å¡è¨ä¸", "è™šç©ºè¡Œè€…"],
        "Katarina": ["å¡ç‰¹", "ä¸ç¥¥ä¹‹åˆƒ", "æ—‹è½¬"],
        "Kayle": ["å¤©ä½¿", "å‡¯å°”"],
        "Kayn": ["å‡¯éš", "çº¢å‡¯", "è“å‡¯"],
        "Kennen": ["å‡¯å—", "ç”µè€—å­"],
        "Khazix": ["è³è‚", "å¡å…¹å…‹", "é£å¤©"],
        "Kindred": ["åƒç", "ç¾Šçµ", "ç‹¼çµ"],
        "Kled": ["å…‹çƒˆ", "èœ¥èœ´"],
        "KogMaw": ["å¤§å˜´", "å…‹æ ¼è«"],
        "KSante": ["å¥æ¡‘æ", "é»‘å“¥", "ä½“è‚²ç”Ÿ"],
        "Leblanc": ["å¦–å§¬", "ä¹èŠ™å…°", "ä¸€æ¡å§"],
        "LeeSin": ["ç›²åƒ§", "çå­", "æé’", "çš®é‹"],
        "Leona": ["æ—¥å¥³", "è•¾æ¬§å¨œ", "å¥³å¦"],
        "Lillia": ["è‰è‰å¨…", "å°é¹¿", "å«ç¾è““è•¾"],
        "Lissandra": ["å†°å¥³", "ä¸½æ¡‘å“"],
        "Lucian": ["å¢é”¡å®‰", "åœ£æªæ¸¸ä¾ ", "å¥¥å·´é©¬", "åŒæª"],
        "Lulu": ["éœ²éœ²", "ç’ç’", "ç´«çš®å¤§è’œ"],
        "Lux": ["å…‰è¾‰", "æ‹‰å…‹ä¸", "å…‰å¤´"], // æœ‰æ—¶ä¼šæ··æ·†ï¼Œä½†å…‰è¾‰æ˜¯ä¸»æµ
        "Malphite": ["çŸ³å¤´äºº", "å¢¨è²ç‰¹", "æ··åˆ†å·¨å…½"],
        "Malzahar": ["èš‚èš±", "é©¬å°”æ‰å“ˆ"],
        "Maokai": ["å¤§æ ‘", "èŒ‚å‡¯"],
        "MasterYi": ["å‰‘åœ£", "æ˜“å¤§å¸ˆ", "ç–¯ç‹—"],
        "Milio": ["ç±³åˆ©æ¬§", "ç«é¾™æœ"],
        "MissFortune": ["å¥³æª", "å¥½è¿å§", "å„è¿å°å§"],
        "Mordekaiser": ["é“ç”·", "è«å¾·å‡¯æ’’"],
        "Morgana": ["è«ç”˜å¨œ", "æ‘¸å¾—å¤§"],
        "Naafiri": ["çº³äºšè²åˆ©", "ç‹—ç¾¤", "æš—è£”é­”çŠ¬"],
        "Nami": ["å¨œç¾", "å”¤æ½®é²›å§¬"],
        "Nasus": ["ç‹—å¤´", "å†…ç‘Ÿæ–¯", "æ²™æ¼ æ­»ç¥"],
        "Nautilus": ["æ³°å¦", "è¯ºæå‹’æ–¯", "æ·±æµ·æ³°å¦"],
        "Neeko": ["å¦®è”»", "å˜è‰²é¾™"],
        "Nidalee": ["è±¹å¥³", "å¥ˆå¾·ä¸½"],
        "Nilah": ["å°¼èˆ", "æ°´é­"],
        "Nocturne": ["æ¢¦é­‡", "é­”è…¾", "å…³ç¯"],
        "Nunu": ["åŠªåŠª", "é›ªäºº"],
        "Olaf": ["å¥¥æ‹‰å¤«", "ç‹‚æˆ˜å£«", "è½å¤«"],
        "Orianna": ["å‘æ¡", "å¥¥è‰å®‰å¨œ"],
        "Ornn": ["å¥¥æ©", "æ‰“é“çš„", "ç¾Š"],
        "Pantheon": ["æ½˜æ£®", "æ–¯å·´è¾¾"],
        "Poppy": ["æ³¢æ¯”", "é”¤å½¢æ€å°ç‚®"],
        "Pyke": ["æ´¾å…‹", "æ°´é¬¼"],
        "Qiyana": ["å¥‡äºšå¨œ", "åœˆå­å¦ˆ"],
        "Quinn": ["å¥å› ", "é¸Ÿäºº"],
        "Rakan": ["æ´›"],
        "Rammus": ["é¾™é¾Ÿ", "æ‹‰è«æ–¯"],
        "RekSai": ["æŒ–æ˜æœº", "é›·å…‹å¡", "å¥³ç‹"],
        "Rell": ["èŠ®å°”", "é©¬æœ¯å°‘å¥³"],
        "Renata": ["çƒˆå¨œå¡”", "ç‚¼é‡‘ç”·çˆµ"],
        "Renekton": ["é³„é±¼", "é›·å…‹é¡¿", "è’æ¼ å± å¤«"],
        "Rengar": ["ç‹®å­ç‹—", "é›·æ©åŠ å°”"],
        "Riven": ["ç‘æ–‡", "é”é›¯", "å…‰é€ŸQA"],
        "Rumble": ["å…°åš", "çƒ§çƒ¤æ‘Š"],
        "Ryze": ["ç‘å…¹", "æµæµª", "å…‰å¤´", "å¤§é­”ç‹"],
        "Samira": ["èå¼¥æ‹‰", "è¨ç±³æ‹‰"],
        "Sejuani": ["çŒªå¦¹", "ç‘Ÿåº„å¦®"],
        "Senna": ["èµ›å¨œ", "å¥¶ç‹™"],
        "Seraphine": ["è¨å‹’èŠ¬å¦®", "è½®æ¤…äºº", "æ­Œå§¬"],
        "Sett": ["ç‘Ÿæ", "è…•è±ª", "åŠ²å¤«", "å¹ä¸ºè§‚æ­¢"], // åŒ…å«äº‰è®®ä½†å¸¸ç”¨ç§°å‘¼
        "Shaco": ["å°ä¸‘", "è¨ç§‘", "æ¶é­”å°ä¸‘"],
        "Shen": ["æ…", "è…°å­"],
        "Shyvana": ["é¾™å¥³", "å¸Œç“¦å¨œ"],
        "Singed": ["ç‚¼é‡‘", "è¾›å‰å¾·"],
        "Sion": ["å¡æ©", "è€å¸æœº", "äº¡çµæˆ˜ç¥"],
        "Sivir": ["è½®å­å¦ˆ", "å¸Œç»´å°”"],
        "Skarner": ["èå­", "æ–¯å¡çº³"],
        "Smolder": ["æ–¯è«å¾·", "å°ç«é¾™", "å¦ˆå®é¾™"],
        "Sona": ["ç´å¥³", "å¨‘å¨œ", "36D"],
        "Soraka": ["ç´¢æ‹‰å¡", "å¥¶å¦ˆ", "æ˜Ÿå¦ˆ"],
        "Swain": ["æ–¯ç»´å› ", "ä¹Œé¸¦", "ç»Ÿé¢†"],
        "Sylas": ["å¡æ‹‰æ–¯", "å·ç”·"],
        "Syndra": ["è¾›å¾·æ‹‰", "çƒå¥³"],
        "TahmKench": ["å¡”å§†", "è›¤èŸ†", "æ²³æµä¹‹ç‹"],
        "Taliyah": ["å²©é›€", "å¡”è‰å­"],
        "Talon": ["ç”·åˆ€", "æ³°éš†"],
        "Taric": ["å®çŸ³", "å¡”é‡Œå…‹"],
        "Teemo": ["æè«", "æç™¾ä¸‡", "å¿…é¡»æ­»"],
        "Thresh": ["é”¤çŸ³"],
        "Tristana": ["å°ç‚®", "å´”ä¸å¡”å¨œ"],
        "Trundle": ["å·¨é­”", "ç‰¹æœ—å¾·å°”", "æŸ±å­"],
        "Tryndamere": ["è›®ç‹", "æ³°è¾¾ç±³å°”", "äº”ç§’ç”·"],
        "TwistedFate": ["å¡ç‰Œ", "å´”æ–¯ç‰¹"],
        "Twitch": ["è€é¼ ", "å›¾å¥‡"],
        "Udyr": ["ä¹Œè¿ªå°”", "å…½çµè¡Œè€…"],
        "Urgot": ["å„åŠ ç‰¹", "èƒèŸ¹"],
        "Varus": ["éŸ¦é²æ–¯", "ç»´é²æ–¯"],
        "Vayne": ["è–‡æ©", "vn", "æ¾¡å­å“¥"],
        "Veigar": ["å°æ³•", "ç»´è¿¦"],
        "Velkoz": ["å¤§çœ¼", "ç»´å…‹å…¹"],
        "Vex": ["è–‡å¤ä¸", "ç†¬å¤œæ³¢æ¯”"],
        "Vi": ["è”š", "æ¥šé›¨è¨", "é“æ‹³"],
        "Viego": ["ä½›è€¶æˆˆ", "ç—›è´¯å¤©çµ", "ç ´è´¥ç‹"],
        "Viktor": ["ç»´å…‹æ‰˜", "ä¸‰åªæ‰‹"],
        "Vladimir": ["å¸è¡€é¬¼", "çŒ©çº¢æ”¶å‰²è€…"],
        "Volibear": ["ç‹—ç†Š", "æ²ƒåˆ©è´å°”"],
        "Warwick": ["ç‹¼äºº", "æ²ƒé‡Œå…‹"],
        "Wukong": ["çŒ´å­", "å­™æ‚Ÿç©º"],
        "Xayah": ["éœ"],
        "Xerath": ["æ³½æ‹‰æ–¯", "ä¸‰ç‚®"],
        "XinZhao": ["èµµä¿¡", "èŠèŠ±ä¿¡"],
        "Yasuo": ["äºšç´¢", "æ‰˜å„¿ç´¢", "å¿«ä¹é£ç”·", "0/21/0"],
        "Yone": ["æ°¸æ©", "å°é­”å‰‘é­‚"],
        "Yorick": ["çº¦é‡Œå…‹", "ç‰§é­‚äºº", "æ˜å¢“"],
        "Yuumi": ["æ‚ ç±³", "çŒ«å’ª", "æŒ‚ä»¶"],
        "Zac": ["æ‰å…‹", "ç”ŸåŒ–é­”äºº"],
        "Zed": ["åŠ«", "å„¿ç«¥åŠ«", "å½±æµä¹‹ä¸»"],
        "Zeri": ["æ³½ä¸½", "ç”µå…‰è€—å­"],
        "Ziggs": ["ç‚¸å¼¹äºº", "å‰æ ¼æ–¯"],
        "Zilean": ["æ—¶å…‰", "åŸºå…°", "è€å¤´"],
        "Zoe": ["ä½ä¼Š", "æš®å…‰æ˜Ÿçµ"],
        "Zyra": ["å©•æ‹‰"]
    };

    // --- åˆå§‹åŒ–åŠ è½½ ---
    window.onload = async () => {
        try {
            const verRes = await fetch(`${DD_BASE}/api/versions.json`);
            const versions = await verRes.json();
            gameState.version = versions[0];
            
            const champRes = await fetch(`${DD_BASE}/cdn/${gameState.version}/data/zh_CN/champion.json`);
            const champData = await champRes.json();
            gameState.champions = champData.data;

            // å‡†å¤‡å®Œæˆ
            document.getElementById('loading-status').innerText = "èµ„æºåŠ è½½å®Œæ¯•";
            document.getElementById('loading-status').style.color = "#0AC8B9";
            document.getElementById('start-game-btn').classList.add('ready');

        } catch (error) {
            document.getElementById('loading-status').innerText = "åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ";
        }
    };

    function selectMode(mode) {
        gameState.mode = mode;
        document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`btn-${mode}`).classList.add('active');
    }

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('game-ui').style.display = 'block';
        
        // æ›´æ–° UI æ–‡æœ¬
        document.getElementById('current-mode-text').innerText = gameState.mode === 'normal' ? 'æ­£å¸¸' : 'å›°éš¾';
        document.getElementById('question-text').innerText = gameState.mode === 'normal' ? 'è¿™åˆæ˜¯å“ªä¸ªè‹±é›„çš„æŠ€èƒ½ï¼Ÿ' : 'è¿™ä¸ªæŠ€èƒ½çš„å®˜æ–¹å…¨åæ˜¯ï¼Ÿ';
        document.getElementById('answer-input').placeholder = gameState.mode === 'normal' ? 'è¾“å…¥è‹±é›„å¤–å·ã€åå­—ã€ç®€ç§°...' : 'å¿…é¡»è¾“å…¥å‡†ç¡®çš„æŠ€èƒ½å…¨å...';
        
        nextRound();

        // ç»‘å®šå›è½¦
        document.getElementById("answer-input").addEventListener("keypress", (e) => {
            if (e.key === "Enter") checkAnswer();
        });
    }

    async function nextRound() {
        // é‡ç½®çŠ¶æ€
        gameState.hintLevel = 0;
        document.getElementById('hint-count').innerText = '(0/2)';
        document.getElementById('message').innerHTML = "";
        document.getElementById('answer-input').value = "";
        document.getElementById('answer-input').disabled = false;
        document.getElementById('answer-input').focus();
        document.getElementById('key-tag').style.display = 'none';

        // éšæœºé€»è¾‘
        const heroKeys = Object.keys(gameState.champions);
        const randomKey = heroKeys[Math.floor(Math.random() * heroKeys.length)];
        const heroSummary = gameState.champions[randomKey];

        try {
            const detailRes = await fetch(`${DD_BASE}/cdn/${gameState.version}/data/zh_CN/champion/${heroSummary.id}.json`);
            const detailData = await detailRes.json();
            gameState.currentHero = detailData.data[heroSummary.id];
            
            const roll = Math.floor(Math.random() * 5); // 0=P, 1-4=QWER
            
            if (roll === 0) {
                gameState.currentSkill = {
                    key: "è¢«åŠ¨(P)",
                    name: gameState.currentHero.passive.name,
                    img: `${DD_BASE}/cdn/${gameState.version}/img/passive/${gameState.currentHero.passive.image.full}`
                };
            } else {
                const spellIndex = roll - 1;
                const spell = gameState.currentHero.spells[spellIndex];
                const keyMap = ['Q', 'W', 'E', 'R'];
                gameState.currentSkill = {
                    key: keyMap[spellIndex],
                    name: spell.name,
                    img: `${DD_BASE}/cdn/${gameState.version}/img/spell/${spell.image.full}`
                };
            }

            document.getElementById('skill-img').src = gameState.currentSkill.img;

        } catch (e) {
            console.error("Round Error", e);
            nextRound();
        }
    }

    function checkAnswer() {
        if (!gameState.currentSkill) return;
        
        const inputRaw = document.getElementById('answer-input').value.trim();
        if (!inputRaw) return;

        let isCorrect = false;

        if (gameState.mode === 'normal') {
            // --- æ­£å¸¸æ¨¡å¼åˆ¤å®š (æŸ¥è‹±é›„å + å¤–å·åº“) ---
            const hero = gameState.currentHero;
            const inputLower = inputRaw.toLowerCase().replace(/\s/g, ""); // å»ç©ºæ ¼è½¬å°å†™
            
            // 1. æŸ¥å®˜æ–¹å (æé’)
            if (hero.name === inputRaw) isCorrect = true;
            // 2. æŸ¥ç§°å· (ç›²åƒ§)
            if (hero.title === inputRaw) isCorrect = true;
            // 3. æŸ¥å¤–å·åº“ (çå­, çš®é‹...)
            const aliases = NICKNAME_DB[hero.id];
            if (aliases && aliases.some(alias => alias.toLowerCase() === inputLower)) {
                isCorrect = true;
            }

        } else {
            // --- å›°éš¾æ¨¡å¼åˆ¤å®š (å¿…é¡»æŸ¥æŠ€èƒ½å…¨å) ---
            const inputClean = inputRaw.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, "").toLowerCase();
            const answerClean = gameState.currentSkill.name.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, "").toLowerCase();
            if (inputClean === answerClean) isCorrect = true;
        }

        const msgBox = document.getElementById('message');
        
        if (isCorrect) {
            gameState.score += 10 + gameState.streak * 2;
            gameState.streak++;
            updateScoreboard();
            
            msgBox.innerHTML = `âœ… å›ç­”æ­£ç¡®ï¼<br><span style="color:#aaa; font-size:12px;">${gameState.currentHero.name} - ${gameState.currentSkill.name}</span>`;
            msgBox.className = 'success';
            document.getElementById('answer-input').disabled = true;
            document.getElementById('key-tag').innerText = gameState.currentSkill.key;
            document.getElementById('key-tag').style.display = 'block';

            setTimeout(nextRound, 1500);
        } else {
            gameState.streak = 0;
            updateScoreboard();
            msgBox.innerText = gameState.mode === 'normal' ? "âŒ åå­—ä¸å¯¹å“¦ï¼Œå†æƒ³æƒ³å¤–å·ï¼Ÿ" : "âŒ æŠ€èƒ½å…¨åä¸å¯¹ï¼Œå›°éš¾æ¨¡å¼å¾ˆä¸¥æ ¼ï¼";
            msgBox.className = 'error';
            shakeInput();
        }
    }

    function useHint() {
        if (gameState.hintLevel >= 2) return;
        
        gameState.hintLevel++;
        document.getElementById('hint-count').innerText = `(${gameState.hintLevel}/2)`;
        const msgBox = document.getElementById('message');
        
        // åŠ¨æ€æç¤ºå†…å®¹
        if (gameState.mode === 'normal') {
            // æ­£å¸¸æ¨¡å¼ï¼šæç¤ºæŠ€èƒ½ä½ç½® -> æç¤ºç§°å·
            if (gameState.hintLevel === 1) {
                msgBox.innerHTML = `ğŸ’¡ æç¤º 1ï¼šè¿™æ˜¯ <b>${gameState.currentSkill.key}</b> æŠ€èƒ½`;
            } else {
                msgBox.innerHTML = `ğŸ’¡ æç¤º 2ï¼šä»–çš„ç§°å·æ˜¯ <b>${gameState.currentHero.title}</b>`;
            }
        } else {
            // å›°éš¾æ¨¡å¼ï¼šæç¤ºæŠ€èƒ½ä½ç½® -> æç¤ºè‹±é›„å
            if (gameState.hintLevel === 1) {
                msgBox.innerHTML = `ğŸ’¡ æç¤º 1ï¼šè¿™æ˜¯ <b>${gameState.currentSkill.key}</b> æŠ€èƒ½`;
            } else {
                msgBox.innerHTML = `ğŸ’¡ æç¤º 2ï¼šæ‰€å±è‹±é›„ <b>${gameState.currentHero.name}</b>`;
            }
        }
        msgBox.className = 'info';
    }

    function skipRound() {
        gameState.streak = 0;
        updateScoreboard();
        const msgBox = document.getElementById('message');
        msgBox.innerHTML = `ğŸ‘€ ç­”æ¡ˆï¼š${gameState.currentHero.name} [${gameState.currentSkill.name}]`;
        msgBox.className = 'info';
        setTimeout(nextRound, 2000);
    }

    function updateScoreboard() {
        document.getElementById('score').innerText = gameState.score;
        document.getElementById('streak').innerText = gameState.streak;
    }

    function shakeInput() {
        const input = document.getElementById('answer-input');
        input.style.borderColor = 'var(--red)';
        input.style.transform = 'translateX(5px)';
        setTimeout(() => input.style.transform = 'translateX(-5px)', 50);
        setTimeout(() => input.style.transform = 'translateX(5px)', 100);
        setTimeout(() => {
            input.style.transform = 'translateX(0)';
            input.style.borderColor = 'var(--gold-dim)';
        }, 150);
    }

</script>
</body>
</html>
